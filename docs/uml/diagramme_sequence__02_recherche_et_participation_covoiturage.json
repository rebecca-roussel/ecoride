{
  "title": "diagramme_de_séquence _02_Recherche_et_participation_covoiturage",
  "diagramType": "sequence",
  "participants": [
    {
      "id": "2026-01-18T15:00:11.948Z",
      "type": "actor",
      "alias": "Visiteur",
      "label": "Visiteur"
    },
    {
      "id": "2026-01-18T15:01:46.198Z",
      "type": "participant",
      "alias": "IHM",
      "label": "Interface (UI)"
    },
    {
      "id": "2026-01-18T15:02:23.433Z",
      "type": "participant",
      "alias": "API",
      "label": "Serveur"
    },
    {
      "id": "2026-01-18T15:03:48.967Z",
      "type": "database",
      "alias": "BDD",
      "label": "BDD (PostgreSQL)"
    }
  ],
  "sequence": [
    {
      "type": "message",
      "from": "Visiteur",
      "to": "IHM",
      "arrow": "->",
      "label": "Clique sur \"Accéder au covoiturage\"",
      "id": "cce20920-2d57-4b51-bfe6-0c7421f41630"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche la page \"Covoiturages\" (formulaire de recherche, liste vide par défaut)",
      "id": "1ad20d99-bac9-43a5-a98f-0c6052d0ecb2"
    },
    {
      "type": "message",
      "from": "Visiteur",
      "to": "IHM",
      "arrow": "->",
      "label": "Renseigne les critères (départ, arrivée, date) et valide la recherche",
      "id": "da9d68dc-65bf-4922-ae40-af6222a76c05"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "API",
      "arrow": "->",
      "label": "POST /covoiturages/recherche (départ, arrivée, date)",
      "id": "a57ae0aa-39cf-43a9-8aa3-ea7a2855c77f"
    },
    {
      "type": "message",
      "from": "API",
      "to": "BDD",
      "arrow": "->",
      "label": "SELECT covoiturages actifs avec places>0 (départ, arrivée, date)",
      "id": "82d87483-75f4-4fcc-9b76-571cdc7dffad"
    },
    {
      "type": "message",
      "from": "BDD",
      "to": "API",
      "arrow": "-->",
      "label": "Résultats (liste avec places disponibles) ou vide",
      "id": "63348b92-0d1b-41c7-886d-fee42823be95"
    },
    {
      "type": "fragment_start",
      "kind": "alt",
      "label": "[OUI] Covoiturages trouvés",
      "id": "70200caa-a0c6-400c-af37-4d989c3e4cd3"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Retourne la liste des covoiturages",
      "id": "40be3cd8-bc49-4e57-9d5b-c228a81d2979"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche la liste des résultats (inclut places disponibles)",
      "id": "a6721f56-3a23-4ba6-9045-ffacd4035e60"
    },
    {
      "type": "fragment_else",
      "kind": "alt",
      "label": "[NON] Aucun covoiturage trouvé",
      "id": "8e13aa37-4dec-4fb2-93d7-e022d4c00fb0"
    },
    {
      "type": "message",
      "from": "API",
      "to": "BDD",
      "arrow": "->",
      "label": "SELECT date la plus proche dispo (départ, arrivée)",
      "id": "770b98e7-bb1b-4dc4-ae9e-33c29b29a7f6"
    },
    {
      "type": "message",
      "from": "BDD",
      "to": "API",
      "arrow": "-->",
      "label": "Date proche (ou aucune)",
      "id": "185c5a5d-a3c6-4b79-b371-c78f6f37a1b6"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Retourne \"Aucun résultat\" et propose date proche",
      "id": "5046e74c-8423-45cd-8a49-809341132567"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche message + bouton \"Voir à la date proposée\"",
      "id": "366a2920-7fff-46ab-b8c5-279783a105e9"
    },
    {
      "type": "fragment_end",
      "kind": "alt",
      "label": "",
      "id": "7e77b7a2-4337-445c-9cca-7aab54656678"
    },
    {
      "type": "message",
      "from": "Visiteur",
      "to": "IHM",
      "arrow": "->",
      "label": "Clique sur \"Détail\" d’un covoiturage",
      "id": "351ec51d-9401-4347-ba21-0aa089f535f6"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "API",
      "arrow": "->",
      "label": "GET /covoiturages/{id}",
      "id": "d811d373-b7db-4e5f-938a-f4f72cf904f4"
    },
    {
      "type": "message",
      "from": "API",
      "to": "BDD",
      "arrow": "->",
      "label": "SELECT covoiturage + chauffeur + voiture + places disponibles",
      "id": "79276ff3-62aa-4ff1-b161-2b10ee0299eb"
    },
    {
      "type": "message",
      "from": "BDD",
      "to": "API",
      "arrow": "-->",
      "label": "Détails du covoiturage",
      "id": "aed33a1c-3075-4d25-b756-fd9051d52bbb"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Retourne les détails du covoiturage",
      "id": "27a540d7-9020-46d0-84e9-abd8fd0677df"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche la page détail du covoiturage",
      "id": "eac615b4-b406-44c7-8f3e-c3795926fdbc"
    },
    {
      "type": "fragment_start",
      "kind": "alt",
      "label": "[OUI] Utilisateur connecté",
      "id": "3a431778-f4f5-4009-b882-56e66d38aba4"
    },
    {
      "type": "message",
      "from": "Visiteur",
      "to": "IHM",
      "arrow": "->",
      "label": "Clique sur \"Participer\"",
      "id": "abbcd265-1ac2-4040-b877-4bf2d7efd3e6"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "API",
      "arrow": "->",
      "label": "POST /participations (id_covoiturage)",
      "id": "96eff857-9737-412b-ab68-745786a9357b"
    },
    {
      "type": "message",
      "from": "API",
      "to": "BDD",
      "arrow": "->",
      "label": "Vérifie les places disponibles",
      "id": "1d00eb55-2725-4148-8e13-07cb87f36e35"
    },
    {
      "type": "message",
      "from": "BDD",
      "to": "API",
      "arrow": "-->",
      "label": "Places disponibles ?",
      "id": "c150f3b1-a463-4ffe-9dfb-2a056501aafb"
    },
    {
      "type": "fragment_else",
      "kind": "alt",
      "label": "[NON] Utilisateur non connecté",
      "id": "2fcb2b18-892a-46c0-a3ae-cceb26e44bec"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Demande de connexion ou création de compte",
      "id": "489cc303-90f1-4cdc-8478-47c08080a267"
    },
    {
      "type": "fragment_end",
      "kind": "alt",
      "label": "",
      "id": "4683c22e-c365-439e-9dfc-52c6558d37d0"
    },
    {
      "type": "fragment_start",
      "kind": "alt",
      "label": "[OUI] Places disponibles (si utilisateur connecté)",
      "id": "50cef10a-d1b7-4c14-90e0-0337c97915c3"
    },
    {
      "type": "message",
      "from": "API",
      "to": "BDD",
      "arrow": "->",
      "label": "SELECT crédits utilisateur",
      "id": "b1a53b9a-8007-4a93-bf86-d78ac4659cad"
    },
    {
      "type": "message",
      "from": "BDD",
      "to": "API",
      "arrow": "-->",
      "label": "Solde crédits",
      "id": "b4e75bd9-14a6-44b0-b76c-e63caa027272"
    },
    {
      "type": "fragment_else",
      "kind": "alt",
      "label": "[NON] Pas de place (si utilisateur connecté)",
      "id": "4c170be6-57b0-4324-91b0-63410f65fe79"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Refuse participation (plus de place)",
      "id": "6956e5c5-78f1-4837-bcf6-b14ce1091f7d"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche message \"Plus de place disponible\"",
      "id": "7f0e1e68-00ad-4847-b570-96ffd58fe1a1"
    },
    {
      "type": "fragment_end",
      "kind": "alt",
      "label": "",
      "id": "2b86964f-c7ca-408a-b1ca-c54515fd6109"
    },
    {
      "type": "fragment_start",
      "kind": "alt",
      "label": "[OUI] Crédits suffisants (si utilisateur connecté et places disponibles)",
      "id": "4a10980e-26ca-40cf-8def-27c6fea0949f"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Autorise la participation (N crédits requis)",
      "id": "de347ce6-451d-41b1-802c-ccb435edaf28"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche confirmation #1 (utilisation de N crédits)",
      "id": "2ce77250-5576-4224-a902-3cbd2a645785"
    },
    {
      "type": "message",
      "from": "Visiteur",
      "to": "IHM",
      "arrow": "->",
      "label": "Confirme #1",
      "id": "43308254-3054-4a95-b27e-89958063f54e"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche confirmation #2 (validation finale)",
      "id": "94d96e0b-a057-4d99-8521-daf37f18a93a"
    },
    {
      "type": "message",
      "from": "Visiteur",
      "to": "IHM",
      "arrow": "->",
      "label": "Confirme #2",
      "id": "f99313a0-067e-4d52-ab80-8a717c478f52"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "API",
      "arrow": "->",
      "label": "POST /participations/valider (id_covoiturage)",
      "id": "2ca318ff-7bc8-4ad1-8bd6-7158468be1fd"
    },
    {
      "type": "message",
      "from": "API",
      "to": "BDD",
      "arrow": "->",
      "label": "INSERT participation + UPDATE places (-1) + UPDATE crédits (-N)",
      "id": "5a8e8143-34da-4b8c-a7c3-dd6aa4e9809c"
    },
    {
      "type": "message",
      "from": "BDD",
      "to": "API",
      "arrow": "-->",
      "label": "OK",
      "id": "b442a4ad-a7ca-4601-82f2-58273f540b9b"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Participation validée",
      "id": "8aaf7601-adc8-4b5e-9047-dbf32534df6f"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche confirmation \"Participation enregistrée\"",
      "id": "dfb8a868-74ec-4ccb-aabc-6bfbaecf883e"
    },
    {
      "type": "fragment_else",
      "kind": "alt",
      "label": "[NON] Crédits insuffisants (si utilisateur connecté et places disponibles)",
      "id": "89f8b9b0-54bf-4013-a175-3101113be829"
    },
    {
      "type": "message",
      "from": "API",
      "to": "IHM",
      "arrow": "-->",
      "label": "Refuse participation (crédits insuffisants)",
      "id": "0bb0046b-4c4f-4a13-bad1-c1244c95b44f"
    },
    {
      "type": "message",
      "from": "IHM",
      "to": "Visiteur",
      "arrow": "-->",
      "label": "Affiche message \"Crédits insuffisants\" + bouton \"Retour à l’accueil\"",
      "id": "e1f8e86b-5c72-41f1-a4fa-2084acc23d50"
    },
    {
      "type": "fragment_end",
      "kind": "alt",
      "label": "",
      "id": "f8971160-f194-4458-987b-b3fa8632a0e6"
    }
  ]
}